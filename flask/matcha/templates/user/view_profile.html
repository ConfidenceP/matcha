{% extends 'base.html' %} {% block content %}

<p hidden id='user_id'>{{ user['_id'] }}</p>
<p hidden id='current_user_id'>{{ user['_id'] }}</p>
<div class="container">
    <div class="row">
        <div class="col-sm-12">
            <!-- FIX ME! -->
            {% if logged_in in user['flirted'] %}
                {% if user['username'] in current_user['flirted'] %}
                <a href="#" class='btn btn-outline-info btn-sm m-1 disabled'>Chat</a>
                {% else %}
                <a href="#" class='pending btn btn-secondary btn-sm m-1 disabled'>Pending</a>
                {% endif %}
                <button type='button' class='unlike btn btn-secondary btn-sm m1' value="{{ user['username'] }}">unlike</button>
            {% else %}
                {% if user['username'] in current_user['flirted'] %}
                <!-- <a href="{{ url_for('flirts.flirt', username=user['username']) }}" class='btn btn-secondary btn-sm m-1'>Flirt Back</a> -->
                <button type='button' value="{{ user['username'] }}" class='flirt-back btn btn-secondary btn-sm m-1'>Flirt
                    Back</button>
                {% else%}
                <!-- <a href="{{ url_for('flirts.flirt', username=user['username']) }}" class='btn btn-secondary btn-sm m-1'>Flirt</a> -->
                <button type='button' value='{{ user["username"] }}' class='flirt btn btn-secondary btn-sm m-1'>Flirt</button>
                {% endif %}
            {% endif %}
            <a href="{{ url_for('main.block_user', b_id=user['_id']) }}" class='btn btn-secondary btn-sm m-1'>Block</a>
            <a href="{{ url_for('main.report_user', b_id=user['_id']) }}" class='btn btn-secondary btn-sm m-1'>Report as fake
                account</a>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-6">
            <div class="media">
                <img src="{{ url_for('static', filename='profile_pics/' + user['image_name'])}}" alt="profile"
                    class="rounded-circle account-img">
                <div class="media-body">
                    <h6 class='text-muted text-secondary'>Username: </h6>
                    <p>{{ user['username'] }}</p>
                    <h6 class="text-muted text-secondary">Email: </h6>
                    <p>{{ user['email'] }}</p>
                    <h6 class="text-muted text-secondary">Location: </h6>
                    <p>{{ user['location'][2]}}</p>
                    <h6 class="text-muted text-secondary">Fame Rating: </h6>
                    <p>{{ user['fame-rating']}}</p>
                    <h6 class="text-muted text-secondary">Status: </h6>
                    {% if user['username'] in online_users %}
                    <p class='text-muted text-primary'>Online</p>
                    {% else %}
                    <p class='text-muted text-secondary'>Last seen: {{ user['last-seen'].strftime("%H:%M %Y-%m-%d") }}</p>
                    {% endif%}
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <h6>Bio:</h6>
            <p>{{user['bio']}}</p>
            <h6>Interests:</h6>
            {% for interest in user['interests']%}
            <p>{{interest}}</p>
            {%endfor%}
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            {% if current_user['gallery'][0] == null or current_user['gallery'][1] == null or 
                        current_user['gallery'][2] == null or current_user['gallery'][3] == null %}
            <p>Click <b>Gallery</b> to add Pictures to your gallery</p>
            {% else %}
            <div id="carouselExampleControls" class="carousel slide" data-ride="carousel"
                style="width: 250px; height:150px; margin: 0 auto">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img style="width: 100%; border: solid 2px black; box-shadow: 5px 9px 10px #888888" height="150px"
                            width="250px"
                            src="{{ url_for('static', filename='gallery_pics/' + user['gallery'][0])}}" alt="slide">
                    </div>
                    <div class="carousel-item">
                        <img style="width: 100%; border: solid 2px black; box-shadow: 5px 9px 10px #888888" height="150px"
                            width="250px"
                            src="{{ url_for('static', filename='gallery_pics/' + user['gallery'][1])}}" alt="slide">
                    </div>
                    <div class="carousel-item">
                        <img style="width: 100%; border: solid 2px black; box-shadow: 5px 9px 10px #888888" height="150px"
                            width="250px"
                            src="{{ url_for('static', filename='gallery_pics/' + user['gallery'][2])}}" alt="slide">
                    </div>
                    <div class="carousel-item">
                        <img style="width: 100%; border: solid 2px black; box-shadow: 5px 9px 10px #888888" height="150px"
                            width="250px"
                            src="{{ url_for('static', filename='gallery_pics/' + user['gallery'][3])}}" alt="slide">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
            {%endif%}
        </div>
    </div>
</div>
{% endblock content %}
{% block js %}
<script>
    socket = io('http://localhost:5000');

    $(document).ready(function(){
        socket.emit('view', {'viewer': $('#current_user_id').text(), 'viewed': $('#user_id').text()});
    });
</script>
{% endblock js %}